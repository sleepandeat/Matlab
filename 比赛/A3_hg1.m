clear all
Hs=(12+41/60):3/60:(13+41/60);
y=[1.247256205 1.22279459 1.198921486 1.175428964 1.152439573...
    1.12991747 1.10783548 1.086254206 1.065081072 1.044446265...
    1.024264126 1.004640314 0.985490908 0.966790494 0.948584735...
    0.930927881 0.91375175 0.897109051 0.880973762 0.865492259...
    0.850504468];
x0=[110,30,3,110]';
[x,r,J]=nlinfit(Hs,y,'volum2',x0);
x
gl=x(3);
wd=x(2);
L=120;
jd=x(1);
n=x(4);
cwj=23.45*sin(360*(284+n)/365/180*pi);
B=360*(n-81)/364/180*pi;
e=9.87*sin(2*B)-7.53*cos(B)-1.5*sin(B);
H=Hs+(jd-L)/15+e/60;
w=15*(H-12);
h=sin(wd/180*pi)*sin(cwj/180*pi)+cos(wd/180*pi)*cos(cwj/180*pi)*cos(w/180*pi);
y1=gl*sqrt(1-h.^2)./h;  
plot(Hs,y1,'r',Hs,y,'*');