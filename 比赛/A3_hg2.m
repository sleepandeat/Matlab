clear all
Hs=(13+9/60):3/60:(14+9/60);
y=[3.533142184
3.546768029
3.561797643
3.578100715
3.595750783
3.61493428
3.635425983
3.657218272
3.680541115
3.705167836
3.731278025
3.758917911
3.788087888
3.818701015
3.850809619
3.88458522
3.919911828
3.956875992
3.99553479
4.035750835
4.077863059
]';
x0=[110,30,3,110]';
[x,r,J]=nlinfit(Hs,y,'volum3',x0);
x
gl=x(3);
wd=x(2);
L=120;
jd=x(1);
n=x(4);
cwj=23.45*sin(360*(284+n)/365/180*pi);
B=360*(n-81)/364/180*pi;
e=9.87*sin(2*B)-7.53*cos(B)-1.5*sin(B);
H=Hs+(jd-L)/15+e/60;
w=15*(H-12);
h=sin(wd/180*pi)*sin(cwj/180*pi)+cos(wd/180*pi)*cos(cwj/180*pi)*cos(w/180*pi);
y1=gl*sqrt(1-h.^2)./h;  
plot(Hs,y1,'r',Hs,y,'*');