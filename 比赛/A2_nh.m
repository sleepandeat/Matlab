clear all
Hs=(14+42/60):3/60:(15+42/60);   
y=[1.149625826	1.182198976	1.215296955	1.249051052	...
    1.28319534	1.317993149	1.353364049	1.389387091	...
    1.426152856	1.463399853	1.501481622	1.540231817	...
    1.579853316	1.620144515	1.661270613	1.703290633	...
    1.74620591	1.790050915	1.835014272	1.880875001	...
    1.927918447];
x0=[100,20,3];
x=lsqcurvefit('curvefun1',x0,Hs,y);
x
gl=x(3);
wd=x(2);
L=120;
jd=x(1);
n=2*31+28+18;
cwj=23.45*sin(360*(284+n)/365/180*pi);
B=360*(n-81)/364/180*pi;
e=9.87*sin(2*B)-7.53*cos(B)-1.5*sin(B);
H=Hs+(jd-L)/15+e/60;
w=15*(H-12);
h=sin(wd/180*pi)*sin(cwj/180*pi)+cos(wd/180*pi)*cos(cwj/180*pi)*cos(w/180*pi);
y1=gl*sqrt(1-h.^2)./h;  
plot(Hs,y1,'r',Hs,y,'*');
title('直杆太阳影子长度变化曲线')
xlabel('单位小时')
ylabel('影子长度 单位米')